<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Canadian Wollastonite ‚Äì ESG Sustainability Engine</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  >
  <style>
    :root {
      --bg: #0b1720;
      --bg-elevated: #111f2a;
      --bg-soft: #162330;
      --accent: #3bb39c;
      --accent-soft: rgba(59,179,156,0.18);
      --accent-strong: #2a8f7c;
      --accent-yellow: #f3b23a;
      --accent-red: #f25f5c;
      --text-main: #f5f7fb;
      --text-muted: #9fb2c6;
      --border-subtle: rgba(255,255,255,0.06);
      --chip-bg: rgba(255,255,255,0.06);
      --chip-active: #1a3848;
      --shadow-soft: 0 18px 40px rgba(0,0,0,0.55);
      --radius-lg: 16px;
      --radius-xl: 20px;
      --transition-fast: 0.18s ease-out;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #172c3a 0, #050b10 52%, #020508 100%);
      color: var(--text-main);
    }

    body {
      -webkit-font-smoothing: antialiased;
    }

    .app-shell {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header.app-header {
      position: sticky;
      top: 0;
      z-index: 40;
      backdrop-filter: blur(18px);
      background: linear-gradient(to right, rgba(5,14,22,0.96), rgba(10,26,36,0.9));
      border-bottom: 1px solid rgba(255,255,255,0.05);
      padding: 10px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .brand-logo {
      width: 34px;
      height: 34px;
      border-radius: 40%;
      background: radial-gradient(circle at 30% 20%, #7fffd4 0, #3bb39c 40%, #123d33 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      letter-spacing: 0.04em;
      color: #03100c;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.14), 0 14px 30px rgba(0,0,0,0.7);
    }

    .brand-text-title {
      font-size: 18px;
      font-weight: 600;
    }

    .brand-text-sub {
      font-size: 12px;
      color: var(--text-muted);
    }

    .brand-text {
      display: flex;
      flex-direction: column;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .pill-badge {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(59,179,156,0.6);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #b7f3e4;
      background: radial-gradient(circle at top left, rgba(59,179,156,0.25) 0, transparent 60%);
    }

    .layout {
      display: grid;
      grid-template-columns: 240px minmax(0, 1fr);
      min-height: calc(100vh - 64px);
    }

    nav.side-nav {
      border-right: 1px solid rgba(255,255,255,0.05);
      background: linear-gradient(to bottom, #050c13, #050910);
      padding: 18px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .nav-section-label {
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--text-muted);
      opacity: 0.8;
      padding: 0 4px;
    }

    .nav-items {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-item {
      border-radius: 999px;
      padding: 8px 12px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-muted);
      font-size: 13px;
      text-align: left;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      transition: background var(--transition-fast), color var(--transition-fast),
        border-color var(--transition-fast), transform 0.08s ease-out;
    }

    .nav-main-label {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .nav-icon {
      font-size: 15px;
    }

    .nav-item:hover {
      background: rgba(255,255,255,0.04);
      color: #e3f2ff;
      transform: translateY(-1px);
    }

    .nav-item.active {
      background: linear-gradient(120deg, rgba(59,179,156,0.24), rgba(40,122,189,0.35));
      color: #fff;
      border-color: rgba(123, 228, 205, 0.95);
      box-shadow: 0 10px 22px rgba(4, 0, 32, 0.65);
    }

    .nav-item-phase-tag {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.1);
      color: var(--text-muted);
    }

    .nav-footer {
      margin-top: auto;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,0.06);
      font-size: 11px;
      color: var(--text-muted);
    }

    .nav-footer strong {
      color: #e9f5ff;
    }

    main.app-main {
      padding: 18px 22px 26px;
      overflow-y: auto;
    }

    .tab {
      display: none;
      animation: fadeIn 0.2s ease-out;
    }

    .tab.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .grid {
      display: grid;
      gap: 16px;
    }

    .grid-2 {
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.2fr);
    }

    .grid-3 {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    .grid-4 {
      grid-template-columns: repeat(4, minmax(0, 1fr));
    }

    @media (max-width: 1100px) {
      .layout {
        grid-template-columns: 72px minmax(0, 1fr);
      }

      nav.side-nav {
        padding-inline: 10px;
      }

      .nav-item span.nav-item-text {
        display: none;
      }

      .nav-item-phase-tag {
        display: none;
      }

      .nav-section-label {
        display: none;
      }
    }

    @media (max-width: 880px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }

      nav.side-nav {
        flex-direction: row;
        position: sticky;
        top: 56px;
        z-index: 35;
        overflow-x: auto;
        white-space: nowrap;
      }

      .nav-items {
        flex-direction: row;
      }

      .nav-footer {
        display: none;
      }

      main.app-main {
        padding: 14px 14px 20px;
      }

      .grid-2 {
        grid-template-columns: minmax(0, 1fr);
      }

      .grid-3 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .grid-4 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .grid-3,
      .grid-4 {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: radial-gradient(
        circle at top,
        rgba(255,255,255,0.02) 0,
        var(--bg-elevated) 55%,
        #050b10 100%
      );
      border-radius: var(--radius-xl);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
      padding: 14px 16px 16px;
      position: relative;
      overflow: hidden;
    }

    .card-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      color: #e9f4ff;
    }

    .card-subtitle {
      font-size: 12px;
      color: var(--text-muted);
    }

    .badge-soft {
      padding: 3px 9px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      color: var(--text-muted);
    }

    .impact-text {
      font-size: 13px;
      color: #dbe9ff;
      line-height: 1.55;
    }

    .impact-bullets {
      margin-top: 8px;
      padding-left: 18px;
      color: var(--text-muted);
      font-size: 13px;
    }

    .pillars-grid {
      display: grid;
      gap: 12px;
      margin-top: 2px;
    }

    @media (min-width: 900px) {
      .pillars-grid {
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }

    .pillar-card {
      border-radius: 14px;
      background: linear-gradient(145deg, rgba(255,255,255,0.03), rgba(4,24,32,0.9));
      border: 1px solid rgba(157, 210, 199, 0.16);
      padding: 10px 11px 11px;
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 5px;
      position: relative;
      overflow: hidden;
    }

    .pillar-icon {
      font-size: 19px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(59,179,156,0.16);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 4px;
    }

    .pillar-name {
      font-size: 13px;
      font-weight: 600;
    }

    .pillar-desc {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.4;
    }

    .progress-pill {
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .progress-track {
      flex: 1;
      height: 6px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), #5dd6ff);
      width: 0%;
      transition: width 0.3s ease-out;
    }

    .progress-label-strong {
      font-weight: 600;
      color: #e3f5ff;
    }

    .timeline {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 12px;
    }

    .timeline-rail {
      flex: 1;
      height: 5px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      position: relative;
      overflow: hidden;
    }

    .timeline-fill {
      position: absolute;
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #5dd6ff);
      border-radius: inherit;
      width: 0%;
      transition: width 0.3s ease-out;
    }

    .timeline-phases {
      display: flex;
      justify-content: space-between;
      margin-top: 6px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .timeline-phases span strong {
      color: #e9f5ff;
      font-weight: 600;
    }

    .chip {
      padding: 5px 11px;
      border-radius: 999px;
      background: var(--chip-bg);
      border: 1px solid rgba(255,255,255,0.12);
      color: var(--text-muted);
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chip-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(59,179,156,0.28);
    }

    .phase-summary-text {
      font-size: 13px;
      color: #dbe7f6;
      line-height: 1.55;
    }

    .phase-kpi-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 2px;
    }

    .phase-kpi-item {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr) auto;
      gap: 8px;
      font-size: 12px;
      align-items: center;
    }

    @media (max-width: 640px) {
      .phase-kpi-item {
        grid-template-columns: minmax(0, 1fr);
        gap: 4px;
      }
    }

    .phase-kpi-label {
      color: var(--text-muted);
    }

    .phase-kpi-value {
      text-align: right;
      font-weight: 500;
      color: #e7f6ff;
    }

    .phase-kpi-bar-track {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      overflow: hidden;
    }

    .phase-kpi-bar-fill {
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), #5dd6ff);
      width: 0%;
      transition: width 0.3s ease-out;
    }

    .phase-kpi-tag {
      font-size: 10px;
      color: var(--text-muted);
    }

    .pillar-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .pillar-chip-btn {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: var(--chip-bg);
      color: var(--text-muted);
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: background var(--transition-fast), border-color var(--transition-fast),
        color var(--transition-fast), transform 0.08s ease-out;
    }

    .pillar-chip-btn:hover {
      background: rgba(255,255,255,0.08);
      color: #e8f4ff;
      transform: translateY(-1px);
    }

    .pillar-chip-btn.active {
      background: var(--chip-active);
      border-color: rgba(144,238,208,0.9);
      color: #ecfdf8;
      box-shadow: 0 8px 12px rgba(0,0,0,0.5);
    }

    .pillar-chip-index {
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      font-size: 10px;
    }

    .checklist {
      list-style: none;
      padding: 0;
      margin: 8px 0 0;
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .checklist-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .status-dot {
      width: 9px;
      height: 9px;
      border-radius: 50%;
      background: var(--accent);
      flex-shrink: 0;
    }

    .status-dot.in-progress {
      background: var(--accent-yellow);
    }

    .status-dot.not-started {
      background: rgba(255,255,255,0.3);
    }

    .status-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      opacity: 0.9;
    }

    .toc-strip {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-top: 8px;
      font-size: 12px;
    }

    @media (max-width: 720px) {
      .toc-strip {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .toc-column {
      border-radius: 14px;
      background: rgba(7,24,35,0.96);
      border: 1px solid rgba(255,255,255,0.08);
      padding: 9px 10px;
    }

    .toc-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #a8c4dd;
      margin-bottom: 6px;
    }

    .toc-item {
      margin-bottom: 4px;
    }

    .toc-item details {
      background: rgba(255,255,255,0.02);
      border-radius: 10px;
      padding: 4px 7px;
      cursor: pointer;
    }

    .toc-item summary {
      list-style: none;
      font-size: 12px;
      color: #dde9f8;
    }

    .toc-item summary::-webkit-details-marker {
      display: none;
    }

    .toc-item details p {
      margin: 4px 0 2px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .kpi-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
      font-size: 12px;
      align-items: center;
    }

    .kpi-controls label {
      color: var(--text-muted);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .kpi-controls input[type="text"],
    .kpi-controls select {
      background: var(--bg-soft);
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      padding: 6px 9px;
      font-size: 12px;
      color: var(--text-main);
      min-width: 140px;
    }

    .kpi-controls input::placeholder {
      color: rgba(160,184,204,0.7);
    }

    .kpi-table-wrapper {
      max-height: 440px;
      overflow: auto;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.08);
      background: radial-gradient(
        circle at top left,
        rgba(255,255,255,0.03) 0,
        #050c13 58%
      );
    }

    table.kpi-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      color: #d9e5f5;
    }

    .kpi-table thead {
      position: sticky;
      top: 0;
      z-index: 1;
      background: rgba(3,14,24,0.96);
    }

    .kpi-table th,
    .kpi-table td {
      padding: 8px 9px;
      border-bottom: 1px solid rgba(255,255,255,0.04);
      text-align: left;
      white-space: nowrap;
    }

    .kpi-table th {
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
    }

    .kpi-table td {
      font-size: 12px;
    }

    .kpi-table tbody tr {
      cursor: pointer;
      transition: background 0.16s ease-out;
    }

    .kpi-table tbody tr:hover {
      background: rgba(255,255,255,0.04);
    }

    .status-pill {
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      border: 1px solid transparent;
    }

    .status-pill.on-track {
      background: rgba(59,179,156,0.1);
      color: #9bf0d0;
      border-color: rgba(59,179,156,0.7);
    }

    .status-pill.at-risk {
      background: rgba(243,178,58,0.08);
      color: #ffd27a;
      border-color: rgba(243,178,58,0.8);
    }

    .status-pill.not-started {
      background: rgba(159,178,198,0.04);
      color: #a9b9cc;
      border-color: rgba(180,196,214,0.7);
    }

    .data-def-list {
      margin: 8px 0 0;
      padding-left: 18px;
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.6;
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
      font-size: 11px;
    }

    .tag {
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.02);
      color: var(--text-muted);
    }

    .chart-container {
      position: relative;
      width: 100%;
      height: 220px;
    }

    .chart-container-sm {
      position: relative;
      width: 100%;
      height: 190px;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(3,5,9,0.82);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 60;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.18s ease-out;
    }

    .modal-backdrop.active {
      opacity: 1;
      pointer-events: auto;
    }

    .modal {
      width: min(620px, 94vw);
      max-height: 80vh;
      background: radial-gradient(circle at top, #1b3141 0, #050c13 60%);
      border-radius: 18px;
      border: 1px solid rgba(157,210,199,0.35);
      box-shadow: 0 26px 60px rgba(0,0,0,0.9);
      padding: 14px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .modal-title {
      font-size: 15px;
      font-weight: 600;
    }

    .modal-close-btn {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(3,9,14,0.8);
      color: var(--text-muted);
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.16s ease-out, transform 0.08s ease-out;
    }

    .modal-close-btn:hover {
      background: rgba(255,255,255,0.06);
      transform: translateY(-1px);
    }

    .modal-body {
      font-size: 13px;
      color: var(--text-muted);
      overflow-y: auto;
      padding-right: 4px;
    }

    .modal-body strong {
      color: #e7f3ff;
    }

    .modal-body-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.4fr);
      gap: 12px;
      margin-top: 6px;
    }

    @media (max-width: 720px) {
      .modal-body-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .meta-list {
      list-style: none;
      padding: 0;
      margin: 4px 0 0;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    .meta-list span.label {
      color: var(--text-muted);
    }

    .meta-list span.value {
      color: #e3f3ff;
    }

    .meta-row {
      display: flex;
      justify-content: space-between;
      gap: 8px;
    }

    .sparkline-note {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .pill-soft {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(4, 28, 42, 0.9);
      color: #cfe6ff;
      font-size: 11px;
      letter-spacing: 0.09em;
      text-transform: uppercase;
    }

    .kpi-catalog-empty {
      font-size: 12px;
      color: var(--text-muted);
      padding: 8px 10px;
    }

    .section-heading {
      font-size: 17px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .section-subheading {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div class="brand">
        <div class="brand-logo">CW</div>
        <div class="brand-text">
          <span class="brand-text-title">Canadian Wollastonite ‚Äì ESG Sustainability Engine</span>
          <span class="brand-text-sub">Phased Implementation Dashboard (Phase 1‚Äì3)</span>
        </div>
      </div>
      <div class="header-right">
        <div class="pill-badge">Mine-to-Gate ¬∑ Baseline 2025</div>
        <span>Climate-positive mining model ¬∑ Vision 2028</span>
      </div>
    </header>

    <div class="layout">
      <nav class="side-nav">
        <div class="nav-section-label">Navigation</div>
        <div class="nav-items">
          <button class="nav-item active" data-tab-target="overview">
            <div class="nav-main-label">
              <span class="nav-icon">üè†</span>
              <span class="nav-item-text">Overview</span>
            </div>
            <span class="nav-item-phase-tag">Impact View</span>
          </button>
          <button class="nav-item" data-tab-target="phase1">
            <div class="nav-main-label">
              <span class="nav-icon">‚ë†</span>
              <span class="nav-item-text">Phase 1</span>
            </div>
            <span class="nav-item-phase-tag">0‚Äì6 months</span>
          </button>
          <button class="nav-item" data-tab-target="phase2">
            <div class="nav-main-label">
              <span class="nav-icon">‚ë°</span>
              <span class="nav-item-text">Phase 2</span>
            </div>
            <span class="nav-item-phase-tag">6‚Äì15 months</span>
          </button>
          <button class="nav-item" data-tab-target="phase3">
            <div class="nav-main-label">
              <span class="nav-icon">‚ë¢</span>
              <span class="nav-item-text">Phase 3</span>
            </div>
            <span class="nav-item-phase-tag">15‚Äì24 months</span>
          </button>
          <button class="nav-item" data-tab-target="kpiCatalog">
            <div class="nav-main-label">
              <span class="nav-icon">üìä</span>
              <span class="nav-item-text">KPI Catalog</span>
            </div>
            <span class="nav-item-phase-tag">Search & Explore</span>
          </button>
          <button class="nav-item" data-tab-target="dataDefinitions">
            <div class="nav-main-label">
              <span class="nav-icon">‚ìò</span>
              <span class="nav-item-text">Data Definitions</span>
            </div>
            <span class="nav-item-phase-tag">Assumptions</span>
          </button>
        </div>
        <div class="nav-footer">
          Designed for <strong>Canadian Wollastonite (CW)</strong> to connect
          <strong>measurement</strong>, <strong>certification</strong>, and
          <strong>stakeholder trust</strong>.
        </div>
      </nav>

      <main class="app-main">
        <!-- Overview Tab -->
        <section id="tab-overview" class="tab active">
          <div class="grid grid-2">
            <div class="card">
              <div class="card-header">
                <div>
                  <div class="card-title">Impact Vision ¬∑ 2028</div>
                  <div class="card-subtitle">
                    Climate-positive mining model anchored in measurable ESG performance.
                  </div>
                </div>
                <div class="badge-soft">Mine ¬∑ Climate ¬∑ Community</div>
              </div>
              <div class="impact-text">
                By 2028, Canadian Wollastonite (CW) operates a credible
                <strong>climate-positive mining model</strong> that:
                <ul class="impact-bullets">
                  <li>
                    Helps enterprise buyers cut <strong>Scope 3 emissions and nature impacts</strong>
                    using CW‚Äôs low-carbon wollastonite products.
                  </li>
                  <li>
                    Runs an <strong>electrified, low-carbon mine</strong> with verified metrics across
                    carbon, biodiversity, water, restoration, safety, governance, and community.
                  </li>
                  <li>
                    Demonstrably contributes to
                    <strong>climate-change mitigation</strong> through enhanced rock weathering and
                    low-carbon operations.
                  </li>
                  <li>
                    Maintains strong community trust and a
                    <strong>durable social licence to operate</strong> in the Kingston region.
                  </li>
                </ul>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <div>
                  <div class="card-title">Phase Progress Timeline</div>
                  <div class="card-subtitle">
                    Tracking implementation from governance basics to full transparency.
                  </div>
                </div>
                <div class="chip">
                  <span class="chip-dot"></span>
                  Live view: Phases 1‚Äì3
                </div>
              </div>
              <div class="timeline">
                <div class="timeline-rail">
                  <div class="timeline-fill" id="timelineFill"></div>
                </div>
                <div class="pill-soft">Overall 64% Complete</div>
              </div>
              <div class="timeline-phases">
                <span><strong>Phase 1</strong><br>Governance & KPIs ¬∑ 100%</span>
                <span><strong>Phase 2</strong><br>Certification & Data Integrity ¬∑ 70%</span>
                <span><strong>Phase 3</strong><br>Reporting & Engagement ¬∑ 40%</span>
              </div>
              <div style="margin-top: 10px;">
                <div class="card-subtitle">Headline Transition KPIs (Phases 1‚Äì3)</div>
                <div class="chart-container">
                  <canvas id="headlineKpiChart"></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div>
                <div class="card-title">Solution Architecture ¬∑ Four Pillars</div>
                <div class="card-subtitle">
                  A lean ESG system linking measurement, certification, buyer engagement, and transparency.
                </div>
              </div>
              <div class="badge-soft">Pillars Overview</div>
            </div>
            <div class="pillars-grid">
              <div class="pillar-card" data-pillar="1">
                <div class="pillar-icon">‚öôÔ∏è</div>
                <div class="pillar-name">Pillar 1 ‚Äì Build the Measurement Engine</div>
                <div class="pillar-desc">
                  ESG Program Office, mine-to-gate boundaries, and a KPI catalog (15+ KPIs) covering
                  carbon, biodiversity, water, restoration, safety, community, and governance.
                </div>
                <div class="progress-pill">
                  <span class="progress-label-strong">71% Complete</span>
                  <div class="progress-track">
                    <div class="progress-fill" style="width:71%;"></div>
                  </div>
                </div>
              </div>
              <div class="pillar-card" data-pillar="2">
                <div class="pillar-icon">‚úÖ</div>
                <div class="pillar-name">Pillar 2 ‚Äì Certification & Verification Pathway</div>
                <div class="pillar-desc">
                  ISO 14001 readiness, TSM enrollment, evidence logs, incident tracking, and internal ESG
                  audits to support future third-party verification.
                </div>
                <div class="progress-pill">
                  <span class="progress-label-strong">58% Complete</span>
                  <div class="progress-track">
                    <div class="progress-fill" style="width:58%;"></div>
                  </div>
                </div>
              </div>
              <div class="pillar-card" data-pillar="3">
                <div class="pillar-icon">ü§ù</div>
                <div class="pillar-name">Pillar 3 ‚Äì Buyer & Stakeholder Engagement System</div>
                <div class="pillar-desc">
                  Supplier ESG Data Pack, pilot with three priority buyers, quarterly ESG dashboards, and
                  an annual Sustainability Report.
                </div>
                <div class="progress-pill">
                  <span class="progress-label-strong">62% Complete</span>
                  <div class="progress-track">
                    <div class="progress-fill" style="width:62%;"></div>
                  </div>
                </div>
              </div>
              <div class="pillar-card" data-pillar="4">
                <div class="pillar-icon">üåê</div>
                <div class="pillar-name">Pillar 4 ‚Äì Communication Strategy & Transparency Tools</div>
                <div class="pillar-desc">
                  Public microsite, annual Community Forum, advance blasting notifications, and simple
                  explainers on enhanced weathering and carbon removal.
                </div>
                <div class="progress-pill">
                  <span class="progress-label-strong">49% Complete</span>
                  <div class="progress-track">
                    <div class="progress-fill" style="width:49%;"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Phase 1 -->
        <section id="tab-phase1" class="tab">
          <div class="section-heading">
            Phase 1 ‚Äì Governance & Measurement Foundations (Months 0‚Äì6)
          </div>
          <div class="section-subheading">
            Establishing roles, boundaries, and a KPI engine beyond carbon.
          </div>
          <div class="grid grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 1 Focus</div>
                <div class="badge-soft">Foundations</div>
              </div>
              <div class="phase-summary-text">
                Phase 1 establishes the <strong>ESG Program Office</strong>, defines
                <strong>mine-to-gate boundaries</strong> with a 2025 baseline, and builds a
                <strong>cross-cutting KPI Catalog</strong> across carbon, biodiversity, water,
                restoration, safety, community, and governance. Standardized data templates and RACI
                assignments ensure each metric has a clear owner and cadence, enabling CW to launch
                version 1 of its internal leadership dashboard.
              </div>
              <ul class="impact-bullets" style="margin-top: 10px;">
                <li>Hire Sustainability Lead + part-time Data Analyst.</li>
                <li>Confirm mine-to-gate scope and baseline 2025 dataset.</li>
                <li>Design and approve ‚â•15 ESG KPIs with definitions and owners.</li>
                <li>Stand up initial internal ESG dashboard for leadership.</li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 1 KPI Snapshot</div>
                <div class="card-subtitle">
                  Key indicators as the measurement engine goes live.
                </div>
              </div>
              <div class="phase-kpi-list" data-phase="1"></div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">Pillar-by-Pillar Progress ¬∑ Phase 1</div>
              <div class="card-subtitle">
                Explore priorities, activities, and KPIs for each pillar in this phase.
              </div>
            </div>
            <div class="pillar-chips" data-phase="1">
              <button class="pillar-chip-btn active" data-pillar="1">
                <span class="pillar-chip-index">P1</span> Measurement Engine
              </button>
              <button class="pillar-chip-btn" data-pillar="2">
                <span class="pillar-chip-index">P2</span> Certification Pathway
              </button>
              <button class="pillar-chip-btn" data-pillar="3">
                <span class="pillar-chip-index">P3</span> Buyer Engagement
              </button>
              <button class="pillar-chip-btn" data-pillar="4">
                <span class="pillar-chip-index">P4</span> Communication & Transparency
              </button>
            </div>
            <div class="grid grid-2" style="gap: 14px;">
              <div
                class="card"
                style="background: rgba(4,20,30,0.96); box-shadow: none;"
              >
                <div
                  class="card-title"
                  style="font-size: 12px; margin-bottom: 4px;"
                >
                  Phase 1 Activities
                </div>
                <div
                  class="card-subtitle"
                  style="margin-bottom: 8px;"
                >
                  Priority actions for the selected pillar.
                </div>
                <ul
                  class="checklist"
                  data-phase="1"
                  data-role="activities"
                ></ul>
              </div>
              <div
                class="card"
                style="background: rgba(4,20,30,0.96); box-shadow: none;"
              >
                <div
                  class="card-title"
                  style="font-size: 12px; margin-bottom: 4px;"
                >
                  Phase 1 Mini KPIs
                </div>
                <div
                  class="card-subtitle"
                  style="margin-bottom: 8px;"
                >
                  Pillar-specific indicators for this phase.
                </div>
                <div
                  class="phase-kpi-list"
                  data-phase="1"
                  data-role="pillar-kpis"
                ></div>
              </div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">Activities ‚Üí Outputs ‚Üí Outcomes ¬∑ Phase 1</div>
              <div class="card-subtitle">
                How early investments in governance and measurement generate future impact.
              </div>
            </div>
            <div class="toc-strip">
              <div class="toc-column">
                <div class="toc-title">Activities</div>
                <div class="toc-item">
                  <details>
                    <summary>Appoint ESG Program Office</summary>
                    <p>
                      Hire a Sustainability Lead and part-time Data Analyst; define reporting lines to CEO
                      and Board.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Define mine-to-gate boundary</summary>
                    <p>
                      Confirm that KPIs cover extraction, crushing, processing, and site electricity up to
                      product leaving CW‚Äôs gate.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Design KPI Catalog</summary>
                    <p>
                      Co-develop ‚â•15 ESG KPIs across carbon, biodiversity, water, restoration, safety,
                      community, and governance.
                    </p>
                  </details>
                </div>
              </div>
              <div class="toc-column">
                <div class="toc-title">Outputs</div>
                <div class="toc-item">
                  <details>
                    <summary>ESG RACI and data templates</summary>
                    <p>
                      Documented roles, data owners, and standardized templates for monthly and quarterly
                      ESG reporting.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Baseline 2025 ESG dataset</summary>
                    <p>
                      Consolidated mine-to-gate metrics for GHG, water use, land disturbance/restoration,
                      safety, and community.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Leadership dashboard v1</summary>
                    <p>
                      Simple internal dashboard summarizing Phase 1 KPI performance and electrification
                      milestones.
                    </p>
                  </details>
                </div>
              </div>
              <div class="toc-column">
                <div class="toc-title">Outcomes</div>
                <div class="toc-item">
                  <details>
                    <summary>Organizational capability & governance</summary>
                    <p>
                      Sustainability moves from ad-hoc responsibility to a structured ESG function with
                      clear accountability.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Measurement framework & data integrity</summary>
                    <p>
                      Verified mine-to-gate metrics become available for future certification, buyer
                      packs, and transparent reporting.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Foundation for certification & engagement</summary>
                    <p>
                      ISO 14001, TSM, and buyer-ready ESG disclosures become feasible because the data
                      engine is in place.
                    </p>
                  </details>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Phase 2 -->
        <section id="tab-phase2" class="tab">
          <div class="section-heading">
            Phase 2 ‚Äì Certification Readiness & Data Integrity (Months 6‚Äì15)
          </div>
          <div class="section-subheading">
            Converting structured data into verification-ready systems.
          </div>
          <div class="grid grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 2 Focus</div>
                <div class="badge-soft">Verification</div>
              </div>
              <div class="phase-summary-text">
                Phase 2 prepares CW for <strong>ISO 14001 readiness</strong>, initiates
                <strong>TSM enrollment</strong>, and strengthens data integrity through evidence logs,
                incident tracking, and <strong>quarterly internal ESG audits</strong>. CW produces its
                first <strong>baseline ESG dataset</strong> across all KPIs and evolves internal
                dashboards with trend views. The Supplier ESG Data Pack is
                <strong>piloted with three priority buyers</strong> to ensure relevance for procurement
                and financing.
              </div>
              <ul class="impact-bullets" style="margin-top: 10px;">
                <li>Complete ISO 14001 gap assessment and assemble evidence logs.</li>
                <li>Formalize incident and complaint tracking with escalation paths.</li>
                <li>Launch quarterly ESG management reviews and internal audits.</li>
                <li>Pilot Supplier ESG Data Pack with three enterprise buyers.</li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 2 KPI Snapshot</div>
                <div class="card-subtitle">
                  Key indicators as CW moves toward verifiable ESG performance.
                </div>
              </div>
              <div class="phase-kpi-list" data-phase="2"></div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">Pillar-by-Pillar Progress ¬∑ Phase 2</div>
              <div class="card-subtitle">
                Certification, assurance, and buyer-facing artifacts by pillar.
              </div>
            </div>
            <div class="pillar-chips" data-phase="2">
              <button class="pillar-chip-btn active" data-pillar="1">
                <span class="pillar-chip-index">P1</span> Measurement Engine
              </button>
              <button class="pillar-chip-btn" data-pillar="2">
                <span class="pillar-chip-index">P2</span> Certification Pathway
              </button>
              <button class="pillar-chip-btn" data-pillar="3">
                <span class="pillar-chip-index">P3</span> Buyer Engagement
              </button>
              <button class="pillar-chip-btn" data-pillar="4">
                <span class="pillar-chip-index">P4</span> Communication & Transparency
              </button>
            </div>
            <div class="grid grid-2" style="gap: 14px;">
              <div
                class="card"
                style="background: rgba(4,20,30,0.96); box-shadow: none;"
              >
                <div
                  class="card-title"
                  style="font-size: 12px; margin-bottom: 4px;"
                >
                  Phase 2 Activities
                </div>
                <div
                  class="card-subtitle"
                  style="margin-bottom: 8px;"
                >
                  Priority actions for the selected pillar.
                </div>
                <ul
                  class="checklist"
                  data-phase="2"
                  data-role="activities"
                ></ul>
              </div>
              <div
                class="card"
                style="background: rgba(4,20,30,0.96); box-shadow: none;"
              >
                <div
                  class="card-title"
                  style="font-size: 12px; margin-bottom: 4px;"
                >
                  Phase 2 Mini KPIs
                </div>
                <div
                  class="card-subtitle"
                  style="margin-bottom: 8px;"
                >
                  Pillar-specific indicators for this phase.
                </div>
                <div
                  class="phase-kpi-list"
                  data-phase="2"
                  data-role="pillar-kpis"
                ></div>
              </div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">Activities ‚Üí Outputs ‚Üí Outcomes ¬∑ Phase 2</div>
              <div class="card-subtitle">
                How certification readiness and audit cycles build trust.
              </div>
            </div>
            <div class="toc-strip">
              <div class="toc-column">
                <div class="toc-title">Activities</div>
                <div class="toc-item">
                  <details>
                    <summary>ISO 14001 gap assessment</summary>
                    <p>
                      Compare CW‚Äôs EMS practices to ISO requirements, document gaps, and prioritize
                      corrective actions.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>TSM self-assessment</summary>
                    <p>
                      Score CW operations against Towards Sustainable Mining protocols on safety,
                      communities, and environment.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Internal ESG audits</summary>
                    <p>
                      Conduct quarterly internal audits on ESG KPIs, controls, and data quality, with
                      management review.
                    </p>
                  </details>
                </div>
              </div>
              <div class="toc-column">
                <div class="toc-title">Outputs</div>
                <div class="toc-item">
                  <details>
                    <summary>Evidence logs & SOPs</summary>
                    <p>
                      Centralized repository of procedures, monitoring records, complaints, and incident
                      responses.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Baseline ESG dataset</summary>
                    <p>
                      Fully populated KPI dataset (2025 mine-to-gate) suitable for verification and buyer
                      disclosure.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Verified Supplier ESG Data Pack v1</summary>
                    <p>
                      Procurement-ready pack piloted with three buyers, containing LCA insights,
                      electrification progress, and ESG KPIs.
                    </p>
                  </details>
                </div>
              </div>
              <div class="toc-column">
                <div class="toc-title">Outcomes</div>
                <div class="toc-item">
                  <details>
                    <summary>Credibility through certifications</summary>
                    <p>
                      ISO 14001 readiness and TSM progress give enterprise buyers and financiers confidence
                      in CW‚Äôs controls.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Data integrity & assurance</summary>
                    <p>
                      Quarterly audit cycles reduce errors, support third-party verification, and prevent
                      ad-hoc reporting risk.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Buyer & financing access</summary>
                    <p>
                      Verified ESG data improves CW‚Äôs position in sustainability-linked procurement and
                      capital markets.
                    </p>
                  </details>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Phase 3 -->
        <section id="tab-phase3" class="tab">
          <div class="section-heading">
            Phase 3 ‚Äì Transparency, Reporting & Engagement (Months 15‚Äì24)
          </div>
          <div class="section-subheading">
            Taking CW‚Äôs climate-positive story to buyers, communities, and the public.
          </div>
          <div class="grid grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 3 Focus</div>
                <div class="badge-soft">Transparency</div>
              </div>
              <div class="phase-summary-text">
                Phase 3 transforms verified ESG data into
                <strong>public reporting and structured engagement</strong>. CW publishes its first
                <strong>Annual Sustainability Report</strong>, launches a
                <strong>public sustainability microsite</strong>, and rolls out
                <strong>quarterly ESG dashboards</strong> to the board and key customers. An
                <strong>Annual Community Forum</strong> tracks attendance and sentiment, while the
                Supplier ESG Data Pack is shared with additional buyers. ISO 14001 readiness and TSM
                progress are consolidated as CW approaches external verification.
              </div>
              <ul class="impact-bullets" style="margin-top: 10px;">
                <li>
                  Publish CW‚Äôs first Annual Sustainability Report summarizing climate and nature impacts.
                </li>
                <li>
                  Launch public microsite with KPIs, LCA highlights, electrification milestones, and
                  restoration work.
                </li>
                <li>
                  Host Annual Community Forum and log participation and sentiment.
                </li>
                <li>
                  Extend Supplier ESG Data Pack to more buyers and update ISO/TSM progress.
                </li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 3 KPI Snapshot</div>
                <div class="card-subtitle">
                  Headline indicators in a mature, transparent ESG system.
                </div>
              </div>
              <div class="phase-kpi-list" data-phase="3"></div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">Pillar-by-Pillar Progress ¬∑ Phase 3</div>
              <div class="card-subtitle">
                From internal metrics to public climate-positive leadership.
              </div>
            </div>
            <div class="pillar-chips" data-phase="3">
              <button class="pillar-chip-btn active" data-pillar="1">
                <span class="pillar-chip-index">P1</span> Measurement Engine
              </button>
              <button class="pillar-chip-btn" data-pillar="2">
                <span class="pillar-chip-index">P2</span> Certification Pathway
              </button>
              <button class="pillar-chip-btn" data-pillar="3">
                <span class="pillar-chip-index">P3</span> Buyer Engagement
              </button>
              <button class="pillar-chip-btn" data-pillar="4">
                <span class="pillar-chip-index">P4</span> Communication & Transparency
              </button>
            </div>
            <div class="grid grid-2" style="gap: 14px;">
              <div
                class="card"
                style="background: rgba(4,20,30,0.96); box-shadow: none;"
              >
                <div
                  class="card-title"
                  style="font-size: 12px; margin-bottom: 4px;"
                >
                  Phase 3 Activities
                </div>
                <div
                  class="card-subtitle"
                  style="margin-bottom: 8px;"
                >
                  Priority actions for the selected pillar.
                </div>
                <ul
                  class="checklist"
                  data-phase="3"
                  data-role="activities"
                ></ul>
              </div>
              <div
                class="card"
                style="background: rgba(4,20,30,0.96); box-shadow: none;"
              >
                <div
                  class="card-title"
                  style="font-size: 12px; margin-bottom: 4px;"
                >
                  Phase 3 Mini KPIs
                </div>
                <div
                  class="card-subtitle"
                  style="margin-bottom: 8px;"
                >
                  Pillar-specific indicators for this phase.
                </div>
                <div
                  class="phase-kpi-list"
                  data-phase="3"
                  data-role="pillar-kpis"
                ></div>
              </div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">Activities ‚Üí Outputs ‚Üí Outcomes ¬∑ Phase 3</div>
              <div class="card-subtitle">
                Closing the loop between CW‚Äôs operations, buyers, and communities.
              </div>
            </div>
            <div class="toc-strip">
              <div class="toc-column">
                <div class="toc-title">Activities</div>
                <div class="toc-item">
                  <details>
                    <summary>Publish annual Sustainability Report</summary>
                    <p>
                      Report against KPIs, ISO/TSM progress, and climate-positive outcomes for buyers,
                      investors, and communities.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Launch sustainability microsite</summary>
                    <p>
                      Provide a public, non-technical view of CW‚Äôs performance, LCA results, restoration
                      work, and carbon-removal benefits.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Host Annual Community Forum</summary>
                    <p>
                      Share results, gather feedback, and track community sentiment and participation
                      over time.
                    </p>
                  </details>
                </div>
              </div>
              <div class="toc-column">
                <div class="toc-title">Outputs</div>
                <div class="toc-item">
                  <details>
                    <summary>Public KPIs & dashboards</summary>
                    <p>
                      Quarterly ESG dashboards for the board and customers plus public metrics on the
                      microsite.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Expanded ESG Data Pack</summary>
                    <p>
                      Refined Supplier ESG Data Pack distributed to more buyers, integrating feedback from
                      Phase 2 pilots.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Engagement records & sentiment</summary>
                    <p>
                      Attendance, feedback, and sentiment logs supporting continuous improvement and
                      social licence.
                    </p>
                  </details>
                </div>
              </div>
              <div class="toc-column">
                <div class="toc-title">Outcomes</div>
                <div class="toc-item">
                  <details>
                    <summary>Buyer & stakeholder trust</summary>
                    <p>
                      ESG performance is transparent, verifiable, and relevant to enterprise buyer and
                      community expectations.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Climate contribution transparency</summary>
                    <p>
                      Enhanced weathering and low-carbon operations are communicated clearly, linking CW
                      products to Scope 3 reductions.
                    </p>
                  </details>
                </div>
                <div class="toc-item">
                  <details>
                    <summary>Durable social licence</summary>
                    <p>
                      Consistent, honest reporting and engagement reinforce CW‚Äôs standing as a responsible
                      mining partner.
                    </p>
                  </details>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- KPI Catalog -->
        <section id="tab-kpiCatalog" class="tab">
          <div class="section-heading">KPI Catalog</div>
          <div class="section-subheading">
            Search and filter CW‚Äôs ESG KPI set across pillars, categories, and phases.
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">KPI Library</div>
              <div class="card-subtitle">
                All KPIs are mine-to-gate and aligned with CW‚Äôs Theory of Change and four pillars.
              </div>
            </div>
            <div class="kpi-controls">
              <label for="kpi-search">Search</label>
              <input
                type="text"
                id="kpi-search"
                placeholder="Search KPI name‚Ä¶"
              >
              <label for="kpi-filter-pillar">Pillar</label>
              <select id="kpi-filter-pillar">
                <option value="all">All pillars</option>
                <option value="1">Pillar 1 ‚Äì Measurement Engine</option>
                <option value="2">Pillar 2 ‚Äì Certification Pathway</option>
                <option value="3">Pillar 3 ‚Äì Buyer Engagement</option>
                <option value="4">Pillar 4 ‚Äì Communication & Transparency</option>
              </select>
              <label for="kpi-filter-category">Category</label>
              <select id="kpi-filter-category">
                <option value="all">All categories</option>
                <option value="Carbon">Carbon / Climate</option>
                <option value="Biodiversity">Biodiversity & Land</option>
                <option value="Water">Water</option>
                <option value="Restoration">Restoration</option>
                <option value="Safety">Safety</option>
                <option value="Community">Community & Social</option>
                <option value="Governance">Governance</option>
              </select>
            </div>
            <div class="kpi-table-wrapper">
              <table class="kpi-table">
                <thead>
                  <tr>
                    <th>KPI Name</th>
                    <th>Pillar</th>
                    <th>Category</th>
                    <th>Baseline 2025</th>
                    <th>Current (Phase 3)</th>
                    <th>Target 2028</th>
                    <th>Owner</th>
                    <th>Frequency</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="kpi-table-body"></tbody>
              </table>
              <div
                class="kpi-catalog-empty"
                id="kpi-empty"
                style="display:none;"
              >
                No KPIs match your filters. Try adjusting pillar or category.
              </div>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">How to use this catalog</div>
            </div>
            <ul class="data-def-list">
              <li>
                <strong>Click any KPI row</strong> to open a detailed view with definition, rationale, data
                source, and a trend chart across Phases 1‚Äì3 versus the 2028 target.
              </li>
              <li>
                Filter by <strong>Pillar</strong> to see how measurement, certification, buyer engagement,
                or transparency KPIs connect back to CW‚Äôs four-pillar solution.
              </li>
              <li>
                Filter by <strong>Category</strong> to track performance across climate, nature, water,
                safety, community, and governance dimensions.
              </li>
            </ul>
          </div>
        </section>

        <!-- Data Definitions -->
        <section id="tab-dataDefinitions" class="tab">
          <div class="section-heading">Data Definitions & Assumptions</div>
          <div class="section-subheading">
            Context for CW‚Äôs ESG system, reporting boundaries, and illustrative demo values.
          </div>

          <div class="grid grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Reporting Boundary & Baseline</div>
              </div>
              <ul class="data-def-list">
                <li>
                  <strong>Scope:</strong> All KPIs use a <strong>mine-to-gate</strong> boundary ‚Äì from rock
                  extraction through crushing, processing, and on-site electricity to product leaving CW‚Äôs
                  site.
                </li>
                <li>
                  <strong>Baseline year:</strong> 2025 is used as the baseline year, before full
                  electrification is completed.
                </li>
                <li>
                  <strong>Functional units:</strong> Most operational KPIs are reported
                  <strong>per tonne of processed wollastonite</strong> or <strong>per year</strong> at the
                  mine site.
                </li>
                <li>
                  <strong>Electrification:</strong> Phase 2‚Äì3 values assume a progressive switch from diesel
                  to grid electricity and solar PV, reducing carbon intensity over time.
                </li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">Cadence, Owners & Data Sources</div>
              </div>
              <ul class="data-def-list">
                <li>
                  <strong>Cadence:</strong> Operational metrics (carbon, water, safety) are tracked
                  <strong>monthly</strong>; governance and community KPIs are usually
                  <strong>quarterly or annual</strong>.
                </li>
                <li>
                  <strong>Roles:</strong> The ESG Program Office (Sustainability Lead + Data Analyst)
                  coordinates KPI definitions; <strong>Operations, HSE, Finance, and Community
                  Liaison</strong> teams own specific metrics.
                </li>
                <li>
                  <strong>Data sources:</strong> LCA results, fuel and power logs, contractor data,
                  restoration and tree-planting records, complaints and incident registers, board agendas,
                  and community engagement records.
                </li>
                <li>
                  <strong>Demo values:</strong> All numeric values in this dashboard are
                  <strong>illustrative</strong>, designed to show directionally improving performance and do
                  not represent audited data.
                </li>
              </ul>
            </div>
          </div>

          <div class="card" style="margin-top: 16px;">
            <div class="card-header">
              <div class="card-title">Assumptions about Certifications & Engagement</div>
            </div>
            <ul class="data-def-list">
              <li>
                <strong>ISO 14001:</strong> ‚ÄúReadiness %‚Äù reflects progress against ISO 14001 Environmental
                Management System requirements (policies, procedures, monitoring, internal audits,
                management review).
              </li>
              <li>
                <strong>TSM:</strong> ‚ÄúTSM Progress %‚Äù captures CW‚Äôs progress against self-assessment and
                protocol implementation under the Towards Sustainable Mining framework.
              </li>
              <li>
                <strong>Buyer ESG pre-qualification:</strong> ‚ÄúBuyer ESG Pre-Qualification Success Rate‚Äù
                reflects the share of targeted enterprise buyers that accept CW as an ESG-ready supplier.
              </li>
              <li>
                <strong>Community metrics:</strong> Complaints, response times, and forum attendance are
                tracked to support CW‚Äôs social licence and to identify emerging community concerns early.
              </li>
            </ul>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- KPI Modal -->
  <div class="modal-backdrop" id="kpi-modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <div>
          <div class="modal-title" id="kpi-modal-title">KPI Name</div>
          <div class="tag-row" id="kpi-modal-tags"></div>
        </div>
        <button
          class="modal-close-btn"
          id="kpi-modal-close"
          aria-label="Close KPI details"
        >
          √ó
        </button>
      </div>
      <div class="modal-body">
        <div id="kpi-modal-description"></div>
        <div class="modal-body-grid">
          <div>
            <h4
              style="
                margin: 8px 0 4px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.12em;
                color:#a9c5e0;
              "
            >
              Definition & Rationale
            </h4>
            <p
              id="kpi-modal-definition"
              style="margin: 4px 0 6px;"
            ></p>
            <p
              id="kpi-modal-rationale"
              style="margin: 4px 0 6px;"
            ></p>
            <ul class="meta-list">
              <li class="meta-row">
                <span class="label">Data source</span>
                <span class="value" id="kpi-modal-source"></span>
              </li>
              <li class="meta-row">
                <span class="label">Owner</span>
                <span class="value" id="kpi-modal-owner"></span>
              </li>
              <li class="meta-row">
                <span class="label">Frequency</span>
                <span class="value" id="kpi-modal-frequency"></span>
              </li>
              <li class="meta-row">
                <span class="label">Status</span>
                <span class="value" id="kpi-modal-status"></span>
              </li>
            </ul>
          </div>
          <div>
            <h4
              style="
                margin: 8px 0 4px;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 0.12em;
                color:#a9c5e0;
              "
            >
              Phase Trend vs 2028 Target
            </h4>
            <div class="chart-container-sm">
              <canvas id="kpi-modal-chart"></canvas>
            </div>
            <div class="sparkline-note">
              Values are illustrative demo data for visualization across Phases 1‚Äì3.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // --- Demo KPI Data ---
    const kpis = [
      {
        id: "ghg_intensity",
        name: "GHG intensity per tonne (kg CO‚ÇÇe/t)",
        pillar: 1,
        category: "Carbon",
        description: "Operational carbon intensity of processed wollastonite, mine-to-gate.",
        baseline_2025: 5.2,
        phase1_value: 4.0,
        phase2_value: 2.5,
        phase3_value: 1.6,
        target_2028: 0.9,
        owner_role: "Sustainability Lead",
        frequency: "Quarterly",
        status: "On Track",
        direction: "down",
        definition:
          "Total Scope 1 and 2 emissions from mining and processing divided by tonnes of processed wollastonite shipped from CW‚Äôs site.",
        rationale:
          "Buyers want low-carbon inputs; this KPI shows how CW‚Äôs electrification and efficiency reduce embodied emissions in their supply chains.",
        data_source: "LCA model, fuel logs, electricity and solar PV meters"
      },
      {
        id: "diesel_use_per_tonne",
        name: "Diesel use per tonne (L/t)",
        pillar: 1,
        category: "Carbon",
        description: "Litres of diesel consumed per tonne of processed product.",
        baseline_2025: 1.1,
        phase1_value: 0.9,
        phase2_value: 0.4,
        phase3_value: 0.1,
        target_2028: 0.0,
        owner_role: "Operations Manager",
        frequency: "Monthly",
        status: "On Track",
        direction: "down",
        definition: "Total diesel consumption on site divided by tonnes of processed wollastonite.",
        rationale:
          "Diesel is a major GHG hotspot; tracking this KPI shows progress toward a fully electrified, low-carbon mine.",
        data_source: "Fuel purchase and dispensing records, contractor reports"
      },
      {
        id: "restored_land_pct",
        name: "Non-mined land under active restoration (%)",
        pillar: 1,
        category: "Restoration",
        description: "Share of CW‚Äôs property (excluding active pits) in restoration or biodiversity enhancement.",
        baseline_2025: 40,
        phase1_value: 48,
        phase2_value: 55,
        phase3_value: 65,
        target_2028: 75,
        owner_role: "Land Stewardship Lead",
        frequency: "Annual",
        status: "On Track",
        direction: "up",
        definition:
          "Hectares of non-mined land in restoration or biodiversity projects divided by total non-mined hectares.",
        rationale:
          "Demonstrates CW‚Äôs commitment to net environmental gain and supports community and regulator expectations for land stewardship.",
        data_source: "Site maps, restoration project records, GIS surveys"
      },
      {
        id: "trees_planted",
        name: "Native trees planted (cumulative)",
        pillar: 1,
        category: "Restoration",
        description: "Total number of native trees planted on CW‚Äôs property.",
        baseline_2025: 15000,
        phase1_value: 17000,
        phase2_value: 19000,
        phase3_value: 22000,
        target_2028: 26000,
        owner_role: "Land Stewardship Lead",
        frequency: "Annual",
        status: "On Track",
        direction: "up",
        definition:
          "Cumulative count of native trees planted and maintained as part of restoration and offset activities.",
        rationale: "Signals tangible investment in habitat and biodiversity as mining progresses.",
        data_source: "Planting contractor reports, internal restoration logs"
      },
      {
        id: "wetland_area",
        name: "Constructed wetland area (ha)",
        pillar: 1,
        category: "Biodiversity",
        description: "Hectares of constructed wetlands on the CW site.",
        baseline_2025: 3.0,
        phase1_value: 3.4,
        phase2_value: 3.8,
        phase3_value: 4.2,
        target_2028: 5.0,
        owner_role: "Land Stewardship Lead",
        frequency: "Annual",
        status: "On Track",
        direction: "up",
        definition:
          "Area of constructed wetlands designed for habitat, water quality, and biodiversity benefits.",
        rationale: "Supports nature-positive outcomes and demonstrates habitat creation alongside mining.",
        data_source: "Engineering drawings, environmental monitoring reports"
      },
      {
        id: "water_use_per_tonne",
        name: "Freshwater use per tonne (m¬≥/t)",
        pillar: 1,
        category: "Water",
        description: "Freshwater withdrawn per tonne of processed product.",
        baseline_2025: 0.30,
        phase1_value: 0.26,
        phase2_value: 0.22,
        phase3_value: 0.19,
        target_2028: 0.15,
        owner_role: "Operations Manager",
        frequency: "Monthly",
        status: "On Track",
        direction: "down",
        definition: "Total freshwater withdrawals divided by tonnes of processed product.",
        rationale:
          "Water efficiency is important for environmental impact and future resilience to water constraints.",
        data_source: "Flow meters, utility invoices, process water logs"
      },
      {
        id: "recycled_water_pct",
        name: "Process water recycled (%)",
        pillar: 1,
        category: "Water",
        description: "Share of process water demand met by recirculated or recycled water.",
        baseline_2025: 15,
        phase1_value: 25,
        phase2_value: 40,
        phase3_value: 55,
        target_2028: 65,
        owner_role: "Operations Manager",
        frequency: "Quarterly",
        status: "On Track",
        direction: "up",
        definition: "Volume of reused process water divided by total process water consumption.",
        rationale:
          "Reduces freshwater withdrawals and demonstrates efficient water management.",
        data_source: "Water balance calculations, pump and storage data"
      },
      {
        id: "trifr",
        name: "Total recordable injury frequency rate (TRIFR)",
        pillar: 1,
        category: "Safety",
        description: "TRIFR per 200,000 hours worked (CW + contractors).",
        baseline_2025: 3.5,
        phase1_value: 2.7,
        phase2_value: 1.9,
        phase3_value: 1.2,
        target_2028: 0.8,
        owner_role: "HSE Coordinator",
        frequency: "Quarterly",
        status: "On Track",
        direction: "down",
        definition:
          "Number of recordable injuries per 200,000 hours worked, including contractors.",
        rationale:
          "Shows CW‚Äôs safety performance and focus on safe, high-quality jobs.",
        data_source: "Incident logs, contractor HSE reports, HR time tracking"
      },
      {
        id: "near_miss_reports",
        name: "Near-miss reports per month",
        pillar: 1,
        category: "Safety",
        description: "Number of near-miss reports submitted per month.",
        baseline_2025: 1,
        phase1_value: 3,
        phase2_value: 5,
        phase3_value: 6,
        target_2028: 6,
        owner_role: "HSE Coordinator",
        frequency: "Monthly",
        status: "On Track",
        direction: "up",
        definition:
          "Count of near-miss events logged per month by CW employees and contractors.",
        rationale:
          "Higher reporting indicates a strong safety culture and proactive hazard identification.",
        data_source: "Near-miss reporting system, HSE logs"
      },
      {
        id: "community_complaints",
        name: "Community complaints (per year)",
        pillar: 4,
        category: "Community",
        description: "Number of formally logged community complaints per year.",
        baseline_2025: 3,
        phase1_value: 2,
        phase2_value: 1,
        phase3_value: 1,
        target_2028: 0,
        owner_role: "Community Liaison",
        frequency: "Annual",
        status: "On Track",
        direction: "down",
        definition:
          "Formal complaints received from neighbours or community members related to noise, dust, blasting, or traffic.",
        rationale:
          "Helps maintain CW‚Äôs social licence and quickly address community concerns.",
        data_source: "Complaint log required by operating licence, correspondence records"
      },
      {
        id: "complaint_response_time",
        name: "Average complaint response time (hours)",
        pillar: 4,
        category: "Community",
        description: "Average time between complaint receipt and first formal response.",
        baseline_2025: 24,
        phase1_value: 18,
        phase2_value: 12,
        phase3_value: 8,
        target_2028: 4,
        owner_role: "Community Liaison",
        frequency: "Quarterly",
        status: "On Track",
        direction: "down",
        definition:
          "Mean number of hours from when a complaint is logged to when CW responds to the complainant.",
        rationale:
          "Fast responses support trust and demonstrate CW‚Äôs commitment to being a good neighbour.",
        data_source: "Complaint log timestamps, email and phone records"
      },
      {
        id: "community_forum_attendance",
        name: "Annual Community Forum attendance",
        pillar: 4,
        category: "Community",
        description: "Total number of attendees at CW‚Äôs Annual Community Forum.",
        baseline_2025: 0,
        phase1_value: 0,
        phase2_value: 25,
        phase3_value: 40,
        target_2028: 60,
        owner_role: "Community Liaison",
        frequency: "Annual",
        status: "On Track",
        direction: "up",
        definition:
          "Count of participants attending CW‚Äôs open community forum on operations, restoration, and climate impacts.",
        rationale:
          "Shows the depth of engagement and helps gather feedback on CW‚Äôs impacts and communication.",
        data_source: "Event registration, sign-in sheets, online participation data"
      },
      {
        id: "board_esg_updates",
        name: "Board ESG updates per year",
        pillar: 4,
        category: "Governance",
        description: "Frequency of scheduled ESG updates to CW‚Äôs Board of Directors.",
        baseline_2025: 1,
        phase1_value: 2,
        phase2_value: 3,
        phase3_value: 4,
        target_2028: 4,
        owner_role: "CEO / Board Secretary",
        frequency: "Annual",
        status: "On Track",
        direction: "up",
        definition:
          "Number of formal board meetings per year where ESG performance and risks are a standing agenda item.",
        rationale:
          "Integrates ESG considerations into governance and long-term strategy decisions.",
        data_source: "Board agendas, minutes, and presentation materials"
      },
      {
        id: "policy_coverage",
        name: "Coverage of key ESG policies (%)",
        pillar: 4,
        category: "Governance",
        description: "Share of priority ESG policy topics with approved, up-to-date policies.",
        baseline_2025: 35,
        phase1_value: 50,
        phase2_value: 70,
        phase3_value: 85,
        target_2028: 100,
        owner_role: "Sustainability Lead",
        frequency: "Annual",
        status: "On Track",
        direction: "up",
        definition:
          "Percentage of CW‚Äôs priority ESG topics (e.g., environment, human rights, safety, community, anti-corruption) covered by approved policies.",
        rationale:
          "Policy coverage underpins consistent decision-making and supports certification requirements.",
        data_source: "Policy register, legal reviews, ISO and TSM documentation"
      },
      {
        id: "esg_data_completeness",
        name: "ESG data completeness (%)",
        pillar: 1,
        category: "Governance",
        description: "Share of KPI data points submitted on time and in full each reporting cycle.",
        baseline_2025: 55,
        phase1_value: 75,
        phase2_value: 88,
        phase3_value: 94,
        target_2028: 98,
        owner_role: "Data Analyst (ESG Program Office)",
        frequency: "Quarterly",
        status: "On Track",
        direction: "up",
        definition:
          "Measured as the percentage of planned KPI data points that are delivered, validated, and available for reporting.",
        rationale:
          "High completeness underpins auditability, certification, and reliable communication with buyers and communities.",
        data_source: "ESG data pipeline logs, internal audit findings"
      },
      {
        id: "buyer_prequal_rate",
        name: "Buyer ESG pre-qualification success rate (%)",
        pillar: 3,
        category: "Community",
        description:
          "Share of targeted enterprise buyers where CW passes ESG pre-qualification.",
        baseline_2025: 40,
        phase1_value: 55,
        phase2_value: 70,
        phase3_value: 82,
        target_2028: 90,
        owner_role: "Business Development Lead",
        frequency: "Annual",
        status: "On Track",
        direction: "up",
        definition:
          "Percentage of enterprise buyers (e.g., tech, grocery, industrial) for which CW meets ESG requirements to be accepted as a supplier.",
        rationale:
          "Shows that CW‚Äôs ESG performance and data meet procurement standards, unlocking growth opportunities.",
        data_source: "Bid responses, supplier onboarding portals, customer feedback"
      },
      {
        id: "iso_readiness",
        name: "ISO 14001 readiness (%)",
        pillar: 2,
        category: "Governance",
        description: "Progress toward ISO 14001 Environmental Management System readiness.",
        baseline_2025: 10,
        phase1_value: 35,
        phase2_value: 70,
        phase3_value: 85,
        target_2028: 100,
        owner_role: "Sustainability Lead",
        frequency: "Quarterly",
        status: "On Track",
        direction: "up",
        definition:
          "Percentage of ISO 14001 EMS requirements that are documented, implemented, and internally reviewed.",
        rationale:
          "Signals CW‚Äôs readiness for external certification and robust environmental management.",
        data_source: "Gap assessments, EMS documentation, internal audit reports"
      },
      {
        id: "tsm_progress",
        name: "TSM protocol implementation progress (%)",
        pillar: 2,
        category: "Governance",
        description: "Completion of priority Towards Sustainable Mining (TSM) protocols.",
        baseline_2025: 0,
        phase1_value: 20,
        phase2_value: 55,
        phase3_value: 70,
        target_2028: 95,
        owner_role: "Sustainability Lead",
        frequency: "Annual",
        status: "At Risk",
        direction: "up",
        definition:
          "Percentage of selected TSM protocols implemented to the targeted performance level (e.g., A or better).",
        rationale:
          "Demonstrates alignment with leading practices for environmental and social performance in mining.",
        data_source: "TSM self-assessments, external reviews (when completed)"
      }
    ];

    // --- Phase & Pillar Activities ---
    const phasePillarActivities = {
      "1": {
        "1": {
          description: "Stand up the ESG measurement engine: staffing, boundaries, and KPI design.",
          activities: [
            { text: "Appoint Sustainability Lead and part-time Data Analyst", status: "Complete" },
            { text: "Confirm mine-to-gate baseline scope for 2025", status: "Complete" },
            { text: "Design and approve ‚â•15 ESG KPIs with definitions and owners", status: "In Progress" },
            { text: "Configure version 1 of internal ESG dashboard for leadership", status: "In Progress" }
          ],
          kpiIds: ["ghg_intensity", "esg_data_completeness", "water_use_per_tonne"]
        },
        "2": {
          description: "Lay the groundwork for ISO 14001 and TSM without overloading the small team.",
          activities: [
            { text: "Identify ISO 14001 scope and key requirements for CW", status: "In Progress" },
            { text: "Map existing procedures to ISO/TSM elements", status: "In Progress" },
            { text: "Define evidence log structure and central repository", status: "Not Started" }
          ],
          kpiIds: ["iso_readiness", "policy_coverage"]
        },
        "3": {
          description: "Prepare CW to respond to buyer ESG requests with consistent information.",
          activities: [
            { text: "Map recurring ESG questions from buyers (e.g., Microsoft, Google)", status: "Complete" },
            { text: "Outline initial Supplier ESG Data Pack structure", status: "In Progress" },
            { text: "Align KPI catalog with buyer expectations", status: "In Progress" }
          ],
          kpiIds: ["buyer_prequal_rate"]
        },
        "4": {
          description: "Seed transparent communication practices with local stakeholders.",
          activities: [
            { text: "Refresh neighbour contact list and communication preferences", status: "Complete" },
            { text: "Standardize logging of complaints and responses", status: "In Progress" },
            { text: "Draft key messages on CW‚Äôs climate-positive ambition", status: "In Progress" }
          ],
          kpiIds: ["community_complaints", "complaint_response_time"]
        }
      },
      "2": {
        "1": {
          description: "Enhance data quality and trend visibility across the KPI catalog.",
          activities: [
            { text: "Automate monthly data extraction for priority KPIs", status: "In Progress" },
            { text: "Implement quarterly data quality checks and corrections", status: "In Progress" },
            { text: "Add trend views to internal ESG dashboard", status: "In Progress" }
          ],
          kpiIds: ["esg_data_completeness", "water_use_per_tonne", "diesel_use_per_tonne"]
        },
        "2": {
          description: "Move from planning to active certification readiness work.",
          activities: [
            { text: "Complete ISO 14001 gap assessment", status: "In Progress" },
            { text: "Launch quarterly internal ESG audits with management review", status: "In Progress" },
            { text: "Submit initial TSM self-assessment", status: "In Progress" }
          ],
          kpiIds: ["iso_readiness", "tsm_progress"]
        },
        "3": {
          description: "Test procurement-ready ESG disclosures with priority buyers.",
          activities: [
            { text: "Produce Supplier ESG Data Pack v1", status: "Complete" },
            { text: "Pilot Data Pack with three enterprise buyers", status: "In Progress" },
            { text: "Capture buyer feedback and refine KPIs/format", status: "In Progress" }
          ],
          kpiIds: ["buyer_prequal_rate"]
        },
        "4": {
          description: "Formalize ESG updates for internal and external stakeholders.",
          activities: [
            { text: "Schedule quarterly ESG dashboard reviews with the board", status: "In Progress" },
            { text: "Develop outline and content plan for Annual Sustainability Report", status: "In Progress" },
            { text: "Design structure for sustainability microsite", status: "Not Started" }
          ],
          kpiIds: ["board_esg_updates", "policy_coverage"]
        }
      },
      "3": {
        "1": {
          description: "Keep the measurement engine robust as volumes and expectations grow.",
          activities: [
            { text: "Expand automation of KPI collection and validation", status: "In Progress" },
            { text: "Integrate enhanced weathering MRV inputs into KPI set", status: "Not Started" },
            { text: "Refine mine-to-gate boundaries as operations expand", status: "In Progress" }
          ],
          kpiIds: ["ghg_intensity", "restored_land_pct", "esg_data_completeness"]
        },
        "2": {
          description: "Consolidate readiness for third-party verification and sustainability-linked finance.",
          activities: [
            { text: "Address ISO 14001 gaps and prepare for external audit", status: "In Progress" },
            { text: "Progress TSM protocol implementation toward target levels", status: "In Progress" },
            { text: "Align ESG disclosures with emerging Canadian climate standards", status: "In Progress" }
          ],
          kpiIds: ["iso_readiness", "tsm_progress"]
        },
        "3": {
          description: "Scale ESG disclosures with buyers while protecting a small team‚Äôs capacity.",
          activities: [
            { text: "Roll out refined Supplier ESG Data Pack to additional buyers", status: "In Progress" },
            { text: "Embed ESG sections into standard proposal templates", status: "Complete" },
            { text: "Track conversion rates linked to ESG performance", status: "In Progress" }
          ],
          kpiIds: ["buyer_prequal_rate"]
        },
        "4": {
          description: "Make CW‚Äôs climate-positive model visible and understandable to the public.",
          activities: [
            { text: "Launch and maintain sustainability microsite", status: "In Progress" },
            { text: "Host Annual Community Forum and capture sentiment", status: "In Progress" },
            { text: "Publish Annual Sustainability Report and quarterly ESG dashboards", status: "In Progress" }
          ],
          kpiIds: ["community_forum_attendance", "community_complaints", "board_esg_updates"]
        }
      }
    };

    const phaseHeadlineKpiIds = ["ghg_intensity", "restored_land_pct", "esg_data_completeness", "iso_readiness"];

    let headlineChart = null;
    let modalChart = null;

    function formatPillarName(pillar) {
      switch (pillar) {
        case 1: return "Pillar 1 ‚Äì Measurement Engine";
        case 2: return "Pillar 2 ‚Äì Certification Pathway";
        case 3: return "Pillar 3 ‚Äì Buyer Engagement";
        case 4: return "Pillar 4 ‚Äì Communication & Transparency";
        default: return "";
      }
    }

    function formatNumber(val) {
      if (typeof val !== "number") return val;
      if (Math.abs(val) >= 1000 && Number.isInteger(val)) return val.toLocaleString();
      if (Math.abs(val) >= 100 || Number.isInteger(val)) return val.toString();
      return val.toFixed(2);
    }

    function getPhaseValue(kpi, phase) {
      return kpi["phase" + phase + "_value"];
    }

    function computeProgress(kpi, phase) {
      const baseline = kpi.baseline_2025;
      const current = getPhaseValue(kpi, phase);
      const target = kpi.target_2028;
      if (current === undefined || target === undefined || baseline === undefined) return 0.5;

      let progress = 0;
      if (kpi.direction === "down") {
        const denom = baseline - target;
        if (denom === 0) return 1;
        progress = (baseline - current) / denom;
      } else {
        const denom = target - baseline;
        if (denom === 0) return 1;
        progress = (current - baseline) / denom;
      }
      progress = Math.max(0, Math.min(1, progress));
      return progress;
    }

    function statusClass(status) {
      if (!status) return "";
      const s = status.toLowerCase();
      if (s === "on track") return "on-track";
      if (s === "at risk") return "at-risk";
      if (s === "not started") return "not-started";
      return "";
    }

    function createPhaseSnapshot(phase) {
      const container = document.querySelector('.phase-kpi-list[data-phase="' + phase + '"]:not([data-role])');
      if (!container) return;
      container.innerHTML = "";

      const selected = phaseHeadlineKpiIds
        .map(id => kpis.find(k => k.id === id))
        .filter(Boolean);

      selected.forEach(kpi => {
        const value = getPhaseValue(kpi, phase);
        const progress = computeProgress(kpi, phase) * 100;

        const item = document.createElement("div");
        item.className = "phase-kpi-item";
        item.innerHTML = `
          <div class="phase-kpi-label">${kpi.name}</div>
          <div>
            <div class="phase-kpi-bar-track">
              <div class="phase-kpi-bar-fill" style="width:${progress.toFixed(0)}%;"></div>
            </div>
          </div>
          <div style="text-align:right;">
            <div class="phase-kpi-value">${formatNumber(value)}</div>
            <div class="phase-kpi-tag">Target 2028: ${formatNumber(kpi.target_2028)}</div>
          </div>
        `;
        container.appendChild(item);
      });
    }

    function renderPhasePillarSection(phase, pillar) {
      const config =
        phasePillarActivities[String(phase)] &&
        phasePillarActivities[String(phase)][String(pillar)];

      const activitiesEl = document.querySelector(
        '.checklist[data-phase="' + phase + '"][data-role="activities"]'
      );
      const pillarKpisEl = document.querySelector(
        '.phase-kpi-list[data-phase="' + phase + '"][data-role="pillar-kpis"]'
      );

      if (!config || !activitiesEl || !pillarKpisEl) return;

      activitiesEl.innerHTML = "";

      const descLi = document.createElement("li");
      descLi.className = "checklist-item";
      descLi.innerHTML = `
        <span class="status-dot in-progress"></span>
        <span><strong>${config.description}</strong></span>
      `;
      activitiesEl.appendChild(descLi);

      config.activities.forEach(act => {
        const li = document.createElement("li");
        li.className = "checklist-item";
        let dotClass = "";
        if (act.status === "Complete") dotClass = "";
        else if (act.status === "In Progress") dotClass = "in-progress";
        else dotClass = "not-started";

        li.innerHTML = `
          <span class="status-dot ${dotClass}"></span>
          <span>${act.text}</span>
          <span class="status-label">${act.status}</span>
        `;
        activitiesEl.appendChild(li);
      });

      pillarKpisEl.innerHTML = "";
      config.kpiIds.forEach(id => {
        const kpi = kpis.find(k => k.id === id);
        if (!kpi) return;

        const value = getPhaseValue(kpi, phase);
        const progress = computeProgress(kpi, phase) * 100;

        const item = document.createElement("div");
        item.className = "phase-kpi-item";
        item.innerHTML = `
          <div class="phase-kpi-label">${kpi.name}</div>
          <div>
            <div class="phase-kpi-bar-track">
              <div class="phase-kpi-bar-fill" style="width:${progress.toFixed(0)}%;"></div>
            </div>
          </div>
          <div style="text-align:right;">
            <div class="phase-kpi-value">${formatNumber(value)}</div>
            <div class="phase-kpi-tag">Target 2028: ${formatNumber(kpi.target_2028)}</div>
          </div>
        `;
        pillarKpisEl.appendChild(item);
      });
    }

    function initPhasePillarInteractions() {
      [1, 2, 3].forEach(phase => {
        createPhaseSnapshot(phase);
        renderPhasePillarSection(phase, 1);
      });

      document.querySelectorAll(".pillar-chips").forEach(wrapper => {
        wrapper.addEventListener("click", e => {
          const btn = e.target.closest(".pillar-chip-btn");
          if (!btn) return;
          const pillar = parseInt(btn.getAttribute("data-pillar"), 10);
          const phase = wrapper.getAttribute("data-phase");

          wrapper.querySelectorAll(".pillar-chip-btn").forEach(b =>
            b.classList.remove("active")
          );
          btn.classList.add("active");

          renderPhasePillarSection(phase, pillar);
        });
      });
    }

    function populateKpiTable() {
      const tbody = document.getElementById("kpi-table-body");
      tbody.innerHTML = "";

      kpis.forEach(kpi => {
        const tr = document.createElement("tr");
        tr.dataset.id = kpi.id;
        tr.dataset.name = kpi.name.toLowerCase();
        tr.dataset.pillar = String(kpi.pillar);
        tr.dataset.category = kpi.category;
        const statusCls = statusClass(kpi.status);

        tr.innerHTML = `
          <td>${kpi.name}</td>
          <td>${formatPillarName(kpi.pillar)}</td>
          <td>${kpi.category}</td>
          <td>${formatNumber(kpi.baseline_2025)}</td>
          <td>${formatNumber(kpi.phase3_value)}</td>
          <td>${formatNumber(kpi.target_2028)}</td>
          <td>${kpi.owner_role}</td>
          <td>${kpi.frequency}</td>
          <td><span class="status-pill ${statusCls}">${kpi.status}</span></td>
        `;
        tbody.appendChild(tr);
      });
    }

    function filterKpiTable() {
      const search = document
        .getElementById("kpi-search")
        .value.trim()
        .toLowerCase();
      const pillarFilter = document.getElementById("kpi-filter-pillar").value;
      const categoryFilter = document.getElementById("kpi-filter-category").value;
      const rows = Array.from(document.querySelectorAll("#kpi-table-body tr"));

      let visibleCount = 0;

      rows.forEach(row => {
        const name = row.dataset.name;
        const pillar = row.dataset.pillar;
        const category = row.dataset.category;
        let visible = true;

        if (search && !name.includes(search)) visible = false;
        if (pillarFilter !== "all" && pillar !== pillarFilter) visible = false;
        if (categoryFilter !== "all" && category !== categoryFilter) visible = false;

        row.style.display = visible ? "" : "none";
        if (visible) visibleCount++;
      });

      const empty = document.getElementById("kpi-empty");
      if (empty) empty.style.display = visibleCount === 0 ? "block" : "none";
    }

    function initKpiFilters() {
      document.getElementById("kpi-search").addEventListener("input", filterKpiTable);
      document.getElementById("kpi-filter-pillar").addEventListener("change", filterKpiTable);
      document.getElementById("kpi-filter-category").addEventListener("change", filterKpiTable);
    }

    function openKpiModal(kpiId) {
      const kpi = kpis.find(k => k.id === kpiId);
      if (!kpi) return;

      document.getElementById("kpi-modal-title").textContent = kpi.name;

      const tags = document.getElementById("kpi-modal-tags");
      tags.innerHTML = `
        <span class="tag">${formatPillarName(kpi.pillar)}</span>
        <span class="tag">${kpi.category}</span>
        <span class="tag">Owner: ${kpi.owner_role}</span>
      `;

      document.getElementById("kpi-modal-description").innerHTML =
        `<p style="margin:4px 0 6px;">${kpi.description}</p>`;
      document.getElementById("kpi-modal-definition").textContent = kpi.definition;
      document.getElementById("kpi-modal-rationale").textContent = kpi.rationale;
      document.getElementById("kpi-modal-source").textContent = kpi.data_source;
      document.getElementById("kpi-modal-owner").textContent = kpi.owner_role;
      document.getElementById("kpi-modal-frequency").textContent = kpi.frequency;

      const sCls = statusClass(kpi.status);
      document.getElementById("kpi-modal-status").innerHTML =
        `<span class="status-pill ${sCls}">${kpi.status}</span>`;

      const ctx = document.getElementById("kpi-modal-chart").getContext("2d");
      if (modalChart) {
        modalChart.destroy();
        modalChart = null;
      }

      modalChart = new Chart(ctx, {
        type: "line",
        data: {
          labels: ["Phase 1", "Phase 2", "Phase 3"],
          datasets: [
            {
              label: "KPI value",
              data: [kpi.phase1_value, kpi.phase2_value, kpi.phase3_value],
              tension: 0.3
            },
            {
              label: "Target 2028",
              data: [kpi.target_2028, kpi.target_2028, kpi.target_2028],
              borderDash: [6, 4],
              tension: 0
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: "#dbe7ff",
                font: { size: 11 }
              }
            }
          },
          scales: {
            x: {
              ticks: {
                color: "#9fb2c6",
                font: { size: 11 }
              },
              grid: { color: "rgba(255,255,255,0.04)" }
            },
            y: {
              ticks: {
                color: "#9fb2c6",
                font: { size: 11 }
              },
              grid: { color: "rgba(255,255,255,0.04)" }
            }
          }
        }
      });

      document.getElementById("kpi-modal-backdrop").classList.add("active");
    }

    function closeKpiModal() {
      document.getElementById("kpi-modal-backdrop").classList.remove("active");
    }

    function initKpiModal() {
      document.getElementById("kpi-modal-close").addEventListener("click", closeKpiModal);
      document.getElementById("kpi-modal-backdrop").addEventListener("click", e => {
        if (e.target.id === "kpi-modal-backdrop") closeKpiModal();
      });
      document
        .getElementById("kpi-table-body")
        .addEventListener("click", e => {
          const tr = e.target.closest("tr");
          if (!tr) return;
          openKpiModal(tr.dataset.id);
        });
    }

    function initNav() {
      const navItems = document.querySelectorAll(".nav-item");
      navItems.forEach(item => {
        item.addEventListener("click", () => {
          const target = item.getAttribute("data-tab-target");
          if (!target) return;

          navItems.forEach(i => i.classList.remove("active"));
          item.classList.add("active");

          document.querySelectorAll(".tab").forEach(tab =>
            tab.classList.remove("active")
          );
          const section = document.getElementById("tab-" + target);
          if (section) section.classList.add("active");
        });
      });
    }

    function initOverviewChart() {
      const ctx = document.getElementById("headlineKpiChart").getContext("2d");

      const datasets = phaseHeadlineKpiIds
        .map(id => {
          const kpi = kpis.find(k => k.id === id);
          if (!kpi) return null;
          return {
            label: kpi.name,
            data: [kpi.phase1_value, kpi.phase2_value, kpi.phase3_value],
            tension: 0.3
          };
        })
        .filter(Boolean);

      headlineChart = new Chart(ctx, {
        type: "line",
        data: {
          labels: ["Phase 1", "Phase 2", "Phase 3"],
          datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: "#dbe7ff",
                font: { size: 11 }
              }
            }
          },
          scales: {
            x: {
              ticks: {
                color: "#9fb2c6",
                font: { size: 11 }
              },
              grid: { color: "rgba(255,255,255,0.04)" }
            },
            y: {
              ticks: {
                color: "#9fb2c6",
                font: { size: 11 }
              },
              grid: { color: "rgba(255,255,255,0.04)" }
            }
          }
        }
      });

      const fill = document.getElementById("timelineFill");
      if (fill) {
        requestAnimationFrame(() => {
          fill.style.width = "64%";
        });
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      initNav();
      populateKpiTable();
      initKpiFilters();
      initKpiModal();
      initPhasePillarInteractions();
      filterKpiTable();
      initOverviewChart();
    });
  </script>
</body>
</html>
